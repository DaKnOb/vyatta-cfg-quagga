type: txt
priority: 719    

help: Set a route-map to selectively unsuppress suppressed routes

comp_help: possible completions:
  <txt>  route-map name

allowed: local -a params
        params=( /opt/vyatta/config/active/policy/route-map/* )
        echo -n ${params[@]##*/}

commit:expression: exec "/opt/vyatta/sbin/vyatta-bgp.pl --check-as --as $VAR(../../@) --neighbor $VAR(../@)"

commit:expression: $VAR(../peer-group/) == ""; "protocols bgp $VAR(../../@) neighbor $VAR(../@): you can't set unsuppress-map for a neighbor in a peer-group"

commit:expression: exec "/opt/vyatta/sbin/vyatta_quagga_utils.pl --exists \"policy route-map $VAR(@)\" ";"protocols bgp $VAR(../../@) neighbor $VAR(../@): route-map $VAR(@) doesn't exist"

update: if [ -n "$VAR(../remote-as/@)" ]; then 
          peer="remote-as $VAR(../remote-as/@)";
        else 
          peer="peer-group $VAR(../peer-group/@)"; 
        fi; 
        if /opt/vyatta/sbin/vyatta-validate-type.pl -q ipv6 $VAR(../@); then  
          vyatta-vtysh -c "configure terminal" \
            -c "router bgp $VAR(../../@)"      \
            -c "address-family ipv6"           \
	    -c "neighbor $VAR(../@) $peer"     \
            -c "address-family ipv6"           \
            -c "neighbor $VAR(../@) unsuppress-map $VAR(@)"
        else
          vyatta-vtysh -c "configure terminal" \
            -c "router bgp $VAR(../../@)"      \
	    -c "neighbor $VAR(../@) $peer"     \
            -c "neighbor $VAR(../@) unsuppress-map $VAR(@)"
        fi;

delete: if /opt/vyatta/sbin/vyatta-validate-type.pl -q ipv6 $VAR(../@); then 
           vyatta-vtysh --noerror          \
             -c "configure terminal"       \
             -c "address-family ipv6"      \
             -c "router bgp $VAR(../../@)" \
             -c "address-family ipv6"      \
             -c "no neighbor $VAR(../@) unsuppress-map $VAR(@)"
        else
           vyatta-vtysh --noerror          \
             -c "configure terminal"       \
             -c "router bgp $VAR(../../@)" \
             -c "no neighbor $VAR(../@) unsuppress-map $VAR(@)"
        fi;
