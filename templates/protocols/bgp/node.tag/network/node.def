tag:
type: ipv4net
help: configure a BGP network
comp_help: \1  <x.x.x.x/x>\tnetwork
syntax:expression: exec "/opt/vyatta/sbin/vyatta_quagga_utils.pl --check-prefix-boundry $VAR(@)";
       "Prefix doesn't fall on a natural boundry"
commit:expression: !($VAR(./backdoor/) != "" && $VAR(./route-map/) != "");
       "protocols bgp $VAR(../@) network $VAR(@): May specify route-map or backdoor but not both"
delete: touch /tmp/`echo $VAR(@) | sed 's!/!!'`.$PPID
end: ${vyatta_sbindir}/vyatta-vtysh.pl -noerr -c "configure terminal" -c "router bgp $VAR(../@)" -c "no network $VAR(@)";

      if [ -f "/tmp/`echo $VAR(@) | sed 's!/!!'`.$PPID" ]; then
        rm -rf /tmp/`echo $VAR(@) | sed 's!/!!'`.$PPID;
      else
        # uncomment and replace the call to vyatta-check-typeless-node.pl pending bug 2525
        #if [ -n \"$VAR(./backdoor/)\" ]; then
        #  COND=\"backdoor\";
        #fi;
        ${vyatta_sbindir}/vyatta-check-typeless-node.pl "protocols bgp $VAR(../@) network $VAR(@) backdoor";
        if [ $? -eq 0 ]; then
          cond="backdoor ";
        fi ;

        if [ -n "$VAR(./route-map/@)" ]; then
          cond="route-map $VAR(./route-map/@)";
        fi;

        ${vyatta_sbindir}/vyatta-vtysh.pl -c "configure terminal" -c "router bgp $VAR(../@)" -c "network $VAR(@) $cond";
      fi;
